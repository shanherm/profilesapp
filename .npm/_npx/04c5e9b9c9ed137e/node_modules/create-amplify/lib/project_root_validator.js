import { existsSync } from 'fs';
import * as path from 'path';
const amplifyLearnMoreUrl = 'https://docs.amplify.aws/gen2/how-amplify-works/';
/**
 * ProjectRootValidator is responsible for validating that the given projectRoot path is a valid target for a new Amplify project
 */
export class ProjectRootValidator {
    projectRoot;
    exists;
    /**
     * Validates that the given projectRoot path is a valid target for a new Amplify project
     */
    constructor(projectRoot, exists = existsSync) {
        this.projectRoot = projectRoot;
        this.exists = exists;
    }
    /**
     * Throws if a file or directory named 'amplify' already exists in the projectRoot
     * No-op if it doesn't exist
     */
    validate = async () => {
        const testPath = path.resolve(this.projectRoot, 'amplify');
        if (this.exists(testPath)) {
            throw new Error(`An amplify directory already exists at ${testPath}. If you are trying to run an Amplify Gen 2 command inside an Amplify Gen 1 project we recommend creating the project in another directory. Learn more about AWS Amplify Gen 2: ${amplifyLearnMoreUrl}`);
        }
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvamVjdF9yb290X3ZhbGlkYXRvci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9wcm9qZWN0X3Jvb3RfdmFsaWRhdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxJQUFJLENBQUM7QUFDaEMsT0FBTyxLQUFLLElBQUksTUFBTSxNQUFNLENBQUM7QUFFN0IsTUFBTSxtQkFBbUIsR0FBRyxrREFBa0QsQ0FBQztBQUUvRTs7R0FFRztBQUNILE1BQU0sT0FBTyxvQkFBb0I7SUFLWjtJQUNBO0lBTG5COztPQUVHO0lBQ0gsWUFDbUIsV0FBbUIsRUFDbkIsU0FBUyxVQUFVO1FBRG5CLGdCQUFXLEdBQVgsV0FBVyxDQUFRO1FBQ25CLFdBQU0sR0FBTixNQUFNLENBQWE7SUFDbkMsQ0FBQztJQUVKOzs7T0FHRztJQUNILFFBQVEsR0FBRyxLQUFLLElBQW1CLEVBQUU7UUFDbkMsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLFNBQVMsQ0FBQyxDQUFDO1FBQzNELElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUN6QixNQUFNLElBQUksS0FBSyxDQUNiLDBDQUEwQyxRQUFRLG1MQUFtTCxtQkFBbUIsRUFBRSxDQUMzUCxDQUFDO1NBQ0g7SUFDSCxDQUFDLENBQUM7Q0FDSCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV4aXN0c1N5bmMgfSBmcm9tICdmcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuXG5jb25zdCBhbXBsaWZ5TGVhcm5Nb3JlVXJsID0gJ2h0dHBzOi8vZG9jcy5hbXBsaWZ5LmF3cy9nZW4yL2hvdy1hbXBsaWZ5LXdvcmtzLyc7XG5cbi8qKlxuICogUHJvamVjdFJvb3RWYWxpZGF0b3IgaXMgcmVzcG9uc2libGUgZm9yIHZhbGlkYXRpbmcgdGhhdCB0aGUgZ2l2ZW4gcHJvamVjdFJvb3QgcGF0aCBpcyBhIHZhbGlkIHRhcmdldCBmb3IgYSBuZXcgQW1wbGlmeSBwcm9qZWN0XG4gKi9cbmV4cG9ydCBjbGFzcyBQcm9qZWN0Um9vdFZhbGlkYXRvciB7XG4gIC8qKlxuICAgKiBWYWxpZGF0ZXMgdGhhdCB0aGUgZ2l2ZW4gcHJvamVjdFJvb3QgcGF0aCBpcyBhIHZhbGlkIHRhcmdldCBmb3IgYSBuZXcgQW1wbGlmeSBwcm9qZWN0XG4gICAqL1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHJlYWRvbmx5IHByb2plY3RSb290OiBzdHJpbmcsXG4gICAgcHJpdmF0ZSByZWFkb25seSBleGlzdHMgPSBleGlzdHNTeW5jXG4gICkge31cblxuICAvKipcbiAgICogVGhyb3dzIGlmIGEgZmlsZSBvciBkaXJlY3RvcnkgbmFtZWQgJ2FtcGxpZnknIGFscmVhZHkgZXhpc3RzIGluIHRoZSBwcm9qZWN0Um9vdFxuICAgKiBOby1vcCBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gICAqL1xuICB2YWxpZGF0ZSA9IGFzeW5jICgpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICBjb25zdCB0ZXN0UGF0aCA9IHBhdGgucmVzb2x2ZSh0aGlzLnByb2plY3RSb290LCAnYW1wbGlmeScpO1xuICAgIGlmICh0aGlzLmV4aXN0cyh0ZXN0UGF0aCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgYEFuIGFtcGxpZnkgZGlyZWN0b3J5IGFscmVhZHkgZXhpc3RzIGF0ICR7dGVzdFBhdGh9LiBJZiB5b3UgYXJlIHRyeWluZyB0byBydW4gYW4gQW1wbGlmeSBHZW4gMiBjb21tYW5kIGluc2lkZSBhbiBBbXBsaWZ5IEdlbiAxIHByb2plY3Qgd2UgcmVjb21tZW5kIGNyZWF0aW5nIHRoZSBwcm9qZWN0IGluIGFub3RoZXIgZGlyZWN0b3J5LiBMZWFybiBtb3JlIGFib3V0IEFXUyBBbXBsaWZ5IEdlbiAyOiAke2FtcGxpZnlMZWFybk1vcmVVcmx9YFxuICAgICAgKTtcbiAgICB9XG4gIH07XG59XG4iXX0=